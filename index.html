<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reactieve Berichten</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
        }
        .dark-mode {
            background-color: #121212;
            color: white;
        }
        .light-mode {
            background-color: white;
            color: black;
        }
        #comments {
            margin-top: 20px;
        }
        .comment {
            background-color: #f0f0f0;
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <h1>Berichten</h1>
    
    <!-- Donkere modus toggle -->
    <label for="mode-toggle">Donkere modus:</label>
    <input type="checkbox" id="mode-toggle">

    <div id="comment-form">
        <input type="text" id="name" placeholder="Jouw naam" required><br>
        <textarea id="message" placeholder="Schrijf een bericht..." required></textarea><br>
        <button id="submit-comment">Verstuur bericht</button>
    </div>

    <h2>Berichten:</h2>
    <div id="comments">
        Geen berichten beschikbaar.
    </div>

    <!-- Voeg Firebase SDK toe -->
    <script src="https://www.gstatic.com/firebasejs/9.0.2/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.2/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.2/firebase-analytics.js"></script>
    <script>
        // Firebase Configuratie
        const firebaseConfig = {
            apiKey: "AIzaSyAPq_Ne7qyMmvMv5HB4yvRttR4_RVFTaWY",
            authDomain: "mrlippie-e902d.firebaseapp.com",
            projectId: "mrlippie-e902d",
            storageBucket: "mrlippie-e902d.firebasestorage.app",
            messagingSenderId: "647573705899",
            appId: "1:647573705899:web:48f2efd835ff2027e493ee",
            measurementId: "G-HJP2XE9JE8"
        };

        // Firebase Initialisatie
        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app); // Verkrijg een referentie naar de database
        const commentsRef = ref(database, 'comments'); // Referentie naar de 'comments' node

        // Donkere modus toggle
        const toggleSwitch = document.getElementById('mode-toggle');
        const body = document.body;
        toggleSwitch.addEventListener('change', () => {
            body.classList.toggle('dark-mode');
        });

        // Verzend het bericht naar Firebase
        const submitButton = document.getElementById('submit-comment');
        submitButton.addEventListener('click', () => {
            const name = document.getElementById('name').value.trim();
            const message = document.getElementById('message').value.trim();

            if (message && name) {
                const newCommentRef = push(commentsRef); // Maak een nieuwe referentie voor het commentaar
                set(newCommentRef, {
                    name: name,
                    message: message,
                }).then(() => {
                    // Clear inputvelden na succesvolle opslaan
                    document.getElementById('name').value = '';
                    document.getElementById('message').value = '';
                }).catch(error => {
                    console.error("Er is een fout opgetreden bij het opslaan van het bericht:", error);
                });
            } else {
                alert("Vul zowel je naam als bericht in!");
            }
        });

        // Functie voor het ophalen en weergeven van berichten
        const commentsDiv = document.getElementById('comments');
        const updateComments = () => {
            get(commentsRef).then((snapshot) => {
                if (snapshot.exists()) {
                    commentsDiv.innerHTML = ''; // Verwijder oude berichten
                    snapshot.forEach((childSnapshot) => {
                        const comment = childSnapshot.val();
                        const commentDiv = document.createElement('div');
                        commentDiv.classList.add('comment');
                        commentDiv.textContent = `${comment.name}: ${comment.message}`;
                        commentsDiv.appendChild(commentDiv);
                    });
                } else {
                    commentsDiv.innerHTML = 'Geen berichten beschikbaar.';
                }
            }).catch(error => {
                console.error("Er is een fout opgetreden bij het ophalen van de berichten:", error);
            });
        };

        // Verkrijg de berichten zodra de pagina wordt geladen
        updateComments();

        // Realtime updates
        onValue(commentsRef, (snapshot) => {
            commentsDiv.innerHTML = ''; // Verwijder oude berichten
            snapshot.forEach((childSnapshot) => {
                const comment = childSnapshot.val();
                const commentDiv = document.createElement('div');
                commentDiv.classList.add('comment');
                commentDiv.textContent = `${comment.name}: ${comment.message}`;
                commentsDiv.appendChild(commentDiv);
            });
        });
    </script>
</body>
</html>
